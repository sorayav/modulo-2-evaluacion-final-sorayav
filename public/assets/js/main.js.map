{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["'use strict';\n\nlet inputSearch = document.querySelector('.search__movie');\nconst btnSearch = document.querySelector('.btn__search');\nconst aside = document.querySelector('aside');\nconst urlBase = 'http://api.tvmaze.com/search/shows?q=';\nlet showList = document.querySelector('.show__shows');\nconst showFavList = document.querySelector('.section__fav--movies');\n\nlet shows = null;\nlet favShows = readLocalStorage();\n\nfunction connectToApi() {\n    fetch(urlBase + inputSearch.value)\n    .then (response => response.json())\n    .then (data => {\n        shows = data;\n        console.log(shows);\n        renderShows(shows);\n        renderFavs(favShows);\n    })\n}\n\nfunction renderShows(arr) {\n    for (let item of arr) {\n    let showImage = item.show.image;\n\n        if (showImage !== null) {\n            showList.innerHTML += `<li id=${item.show.id} class=\"show__list--item\">\n            <h3 class=\"show__title\">${item.show.name}</h3>\n            <img src=\"${item.show.image.medium}\" alt=\"${item.show.name}\">\n            <div class=\"show__item--info\">\n            <span>Género: ${item.show.genres}</span>\n            <a class=\"show__link\" href=${item.show.url} title=\"Ver ficha\" target=\"_blank\"><i class=\"fas fa-chevron-circle-right\"></i> Ver ficha</a>\n            </div>\n            </li>`;            \n        } else { \n            showList.innerHTML += `<li id=${item.show.id} class=\"show__list--item\">\n            <h3 class=\"show__title\">${item.show.name}</h3>\n            <img src=\"https://via.placeholder.com/210x295/cc8383/000\" alt=\"${item.show.name}\">\n            <div class=\"show__item--info\">\n            <span>Género: ${item.show.genres}</span>\n            <a class=\"show__link\" href=${item.show.url} title=\"Ver ficha\" target=\"_blank\"><i class=\"fas fa-chevron-circle-right\"></i> Ver ficha</a>\n            </div>\n            </li>`;\n        }\n        addToFavListeners();\n    }   \n}\n\nfunction addToFavListeners() {\n    const showListElement = document.querySelectorAll('.show__list--item');\n    for (let element of showListElement) {\n        element.addEventListener('click', saveAsFav);\n    }\n}\n\nfunction saveAsFav(event) {\n    const index = parseInt(event.currentTarget.id);\n    if (favShows.indexOf(index) === -1) {\n    favShows.push(index);\n    console.log('Guardada');\n    renderFavs(favShows);\n    setLocalStorage();\n    } else {\n        console.log('Ya está en favoritos');\n    }\n}\n\n// Relacionar el array de ids de favoritos con el objeto al que hace referencia en el array de objetos 'shows'.\n// function getShow(id) {\n//     for (let show of shows) {\n//         if (show.show.id === id) {\n//             return show;\n//         }\n//     }\n// }\n\nfunction getShow(id) {\n    return shows.find(show => show.show.id === id)\n}\n\n\nfunction renderFavs(arrFav) {\n    const sectionFav = document.querySelector('.section__fav--movies');\n    sectionFav.innerHTML = '';\n    // Recorro el array de favoritos\n    for (let favourite of arrFav) {\n        const object = getShow(favourite);\n        if (favourite === object.show.id) {\n            let showImage = object.show.image;\n            aside.classList.remove('hidden');\n                if (showImage !== null) {\n                    sectionFav.innerHTML += `<li id=${object.show.id} class=\"fav__list--item\"><img src=\"${object.show.image.medium}\" alt=\"${object.show.name}\"> <h4>${object.show.name}</h4></li>`;\n                    // const favLiElement = document.querySelector('.fav__list--item');\n                    // favLiElement.classList.add('fav__show--style');\n                    \n                } else {\n                    sectionFav.innerHTML += `<li id=${object.show.id} class=\"fav__list--item\"><img src=\"https://via.placeholder.com/210x295/cc8383/000\" alt=\"${object.show.name}\"><h4>${object.show.name}</h4></li>`; \n                }\n            }\n        }\n}\n\n// LocalStorage\nfunction setLocalStorage() {\n    localStorage.setItem('favourites', JSON.stringify(favShows));\n}\n\nfunction readLocalStorage() {\n    let localFavs = JSON.parse(localStorage.getItem('favourites'));\n\n    if (localFavs !== null) {\n        return localFavs\n    }\n    return localFavs = []\n}\n\n// Function to connect 'Enter' key to search button. \nfunction inputEnter(event) {\n    if(event.keyCode === 13) {\n        btnSearch.click();\n    }\n}\ninputSearch.addEventListener('keyup', inputEnter);\n\nbtnSearch.addEventListener('click', connectToApi);\nconnectToApi();\n"]}